{% extends "base.html" %}

{% block title %}Dashboard - SunDevil Circle{% endblock %}

{% block content %}
<div class="container" style="padding-top: 180px; padding-bottom: 80px;">

    <!-- Welcome Header -->
    <div style="margin-bottom: 24px;">
        <h1 style="font-size: 32px; font-weight: 700; color: var(--text-primary);">
            Welcome back{% if display_name %}, {{ display_name }}{% endif %} ğŸ‘‹
        </h1>
        <p style="color: var(--text-secondary); margin-top: 8px; font-size: 18px;">How can we support you today?</p>
    </div>

    <!-- Sticky Note Tip (dismissible) -->
    <div class="dashboard-tip" id="dashboardTip" style="display: none;">
        <span class="dashboard-tip-icon">ğŸ’¡</span>
        <div class="dashboard-tip-content">
            <strong>Tip: Keep your profile updated!</strong>
            <p>Better profile info helps us match you with the right peers and resources.</p>
        </div>
        <button class="dashboard-tip-dismiss" onclick="dismissTip()" aria-label="Dismiss tip">âœ•</button>
    </div>

    <!-- Action Cards Grid (2 rows x 3 columns) -->
    <div class="steps-grid"
        style="margin-bottom: 48px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px;">
        <!-- Row 1 -->
        <!-- Get Support Card -->
        <a href="{{ url_for('issue') }}" class="step-card" style="text-decoration: none;">
            <div class="step-icon" style="background: #FDE2E4; color: #E11D48;">ğŸ’¬</div>
            <h3 class="step-title">Get Support</h3>
            <p class="step-desc">Share how you're feeling and receive personalized AI-powered guidance.</p>
        </a>

        <!-- Find Groups Card -->
        <a href="{{ url_for('groups_page') }}" class="step-card" style="text-decoration: none;">
            <div class="step-icon" style="background: #ECFDF5; color: #10B981;">ğŸ«¶</div>
            <h3 class="step-title">Find Groups</h3>
            <p class="step-desc">Discover and join support groups around topics that matter to you.</p>
        </a>

        <!-- Find Peers Card -->
        <a href="{{ url_for('people') }}" class="step-card" style="text-decoration: none;">
            <div class="step-icon" style="background: #FEF3C7; color: #F59E0B;">ğŸ”</div>
            <h3 class="step-title">Find Peers</h3>
            <p class="step-desc">Connect with students who understand your experiences.</p>
        </a>

        <!-- Row 2 -->
        <!-- Browse Resources Card -->
        <a href="{{ url_for('resources_hub') }}" class="step-card" style="text-decoration: none;">
            <div class="step-icon" style="background: #D1FAE5; color: #10B981;">ğŸ“š</div>
            <h3 class="step-title">Browse Resources</h3>
            <p class="step-desc">Explore ASU resources, mental health support, academic help, and more.</p>
        </a>

        <!-- My Groups Card -->
        <a href="{{ url_for('groups_page') }}?mine=1" class="step-card" style="text-decoration: none;">
            <div class="step-icon" style="background: #E0F2FE; color: #0284C7;">ğŸ‘¥</div>
            <h3 class="step-title">My Groups</h3>
            <p class="step-desc">View and manage the groups you've joined.</p>
        </a>

        <!-- My Peers Card -->
        <a href="{{ url_for('peers_page') }}" class="step-card" style="text-decoration: none;">
            <div class="step-icon" style="background: #E0E7FF; color: #6366F1;">ğŸ¤</div>
            <h3 class="step-title">My Peers</h3>
            <p class="step-desc">Manage your peer connections and pending requests.</p>
        </a>
    </div>

    <!-- Current Group Section -->
    {% if current_group %}
    <div class="card" style="border-left: 4px solid var(--green-accent);">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
            <div>
                <h3 style="font-size: 20px; font-weight: 600; color: var(--text-primary);">ğŸ‰ You're in a group!</h3>
                <p style="color: var(--text-secondary); margin-top: 4px;">Continue chatting with your peers in
                    <strong>{{ current_group }}</strong>
                </p>
            </div>
            <a href="{{ url_for('chat') }}" class="btn btn-maroon">Go to Chat â†’</a>
        </div>
    </div>
    {% else %}
    <div class="card" style="border-left: 4px solid var(--warning-yellow); background: #FFFBEB;">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
            <div>
                <h3 style="font-size: 20px; font-weight: 600; color: var(--text-primary);">ğŸ’¡ Ready to connect?</h3>
                <p style="color: var(--text-secondary); margin-top: 4px;">Share how you're feeling to get matched with
                    supportive peer groups.</p>
            </div>
            <a href="{{ url_for('issue') }}" class="btn btn-maroon">Get Started â†’</a>
        </div>
    </div>
    {% endif %}

    <!-- Recommended Peers Section -->
    {% if recommended_peers %}
    <div class="card" style="margin-top: 32px;">
        <h3 style="font-size: 20px; font-weight: 600; color: var(--text-primary); margin-bottom: 16px;">
            ğŸ‘¥ Recommended Peers for You
        </h3>
        <div style="display: flex; flex-wrap: wrap; gap: 12px;">
            {% for peer in recommended_peers[:3] %}
            <div style="flex: 1; min-width: 200px; padding: 16px; background: #F9FAFB; border-radius: 12px;">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                    <div
                        style="width: 48px; height: 48px; background: linear-gradient(135deg, #8B1538, #A91D3A); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">
                        {{ peer.display_name[0].upper() if peer.display_name else '?' }}
                    </div>
                    <div>
                        <p style="font-weight: 600; color: var(--text-primary);">{{ peer.display_name }}</p>
                        <p style="font-size: 12px; color: var(--text-secondary);">{{ peer.role|default('Peer Supporter')
                            }}</p>
                    </div>
                </div>
                <a href="{{ url_for('people') }}"
                    style="font-size: 14px; color: var(--primary-maroon); font-weight: 500;">Connect â†’</a>
            </div>
            {% endfor %}
        </div>
        <a href="{{ url_for('people') }}"
            style="display: inline-block; margin-top: 16px; color: var(--primary-maroon); font-weight: 500;">
            See all peer supporters â†’
        </a>
    </div>
    {% endif %}

    <!-- Quick Actions -->
    <div style="margin-top: 32px; text-align: center;">
        <a href="{{ url_for('profile') }}" style="color: var(--primary-maroon); font-weight: 500;">
            âš™ï¸ Update your profile
        </a>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Sticky note functionality
    const TIP_DISMISSED_KEY = 'dashboard_tip_dismissed';

    document.addEventListener('DOMContentLoaded', function () {
        // Show tip if not dismissed before
        if (!localStorage.getItem(TIP_DISMISSED_KEY)) {
            document.getElementById('dashboardTip').style.display = 'flex';
        }
    });

    function dismissTip() {
        document.getElementById('dashboardTip').style.display = 'none';
        localStorage.setItem(TIP_DISMISSED_KEY, 'true');
    }
</script>
{% endblock %}