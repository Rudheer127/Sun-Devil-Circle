{% extends "base.html" %}

{% block title %}Dashboard - SunDevil Circle{% endblock %}

{% block content %}
<div class="container" style="padding-top: 180px; padding-bottom: 80px;">

    <!-- Welcome Header -->
    <div style="margin-bottom: 24px;">
        <h1 style="font-size: 32px; font-weight: 700; color: var(--text-primary);">
            Welcome back{% if display_name %}, {{ display_name }}{% endif %} ğŸ‘‹
        </h1>
        <p style="color: var(--text-secondary); margin-top: 8px; font-size: 18px;">What would you like to do today?</p>
    </div>

    <!-- Sticky Note Tip (dismissible) -->
    <div class="dashboard-tip" id="dashboardTip" style="display: none;">
        <span class="dashboard-tip-icon">ğŸ’¡</span>
        <div class="dashboard-tip-content">
            <strong>Tip: Keep your profile updated!</strong>
            <p>Better profile info helps us match you with the right peers and resources.</p>
        </div>
        <button class="dashboard-tip-dismiss" onclick="dismissTip()" aria-label="Dismiss tip">âœ•</button>
    </div>

    <!-- Action Cards Grid -->
    <div class="steps-grid" style="margin-bottom: 48px;">
        <!-- Get Support Card -->
        <a href="{{ url_for('issue') }}" class="step-card" style="text-decoration: none;">
            <div class="step-icon" style="background: #FDE2E4; color: #E11D48;">ğŸ’¬</div>
            <h3 class="step-title">Share What's On Your Mind</h3>
            <p class="step-desc">Tell us about your challenges and get personalized AI-powered support.</p>
        </a>

        <!-- View Resources Card -->
        <a href="{{ url_for('resources_hub') }}" class="step-card" style="text-decoration: none;">
            <div class="step-icon" style="background: #D1FAE5; color: #10B981;">ğŸ“š</div>
            <h3 class="step-title">Browse Resources</h3>
            <p class="step-desc">Explore ASU resources, mental health support, academic help, and more.</p>
        </a>

        <!-- Find Peers Card -->
        <a href="{{ url_for('people') }}" class="step-card" style="text-decoration: none;">
            <div class="step-icon" style="background: #FEF3C7; color: #F59E0B;">ğŸ‘¥</div>
            <h3 class="step-title">Explore Peer Supporters</h3>
            <p class="step-desc">Browse and connect with fellow students who understand your experiences.</p>
        </a>
    </div>

    <!-- Current Group Section -->
    {% if current_group %}
    <div class="card" style="border-left: 4px solid var(--green-accent);">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
            <div>
                <h3 style="font-size: 20px; font-weight: 600; color: var(--text-primary);">ğŸ‰ You're in a group!</h3>
                <p style="color: var(--text-secondary); margin-top: 4px;">Continue chatting with your peers in
                    <strong>{{ current_group }}</strong>
                </p>
            </div>
            <a href="{{ url_for('chat') }}" class="btn btn-maroon">Go to Chat â†’</a>
        </div>
    </div>
    {% else %}
    <div class="card" style="border-left: 4px solid var(--warning-yellow); background: #FFFBEB;">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
            <div>
                <h3 style="font-size: 20px; font-weight: 600; color: var(--text-primary);">ğŸ’¡ You haven't joined a group
                    yet</h3>
                <p style="color: var(--text-secondary); margin-top: 4px;">Share your challenge to get matched with peer
                    groups that fit your needs.</p>
            </div>
            <a href="{{ url_for('issue') }}" class="btn btn-maroon">Get Started â†’</a>
        </div>
    </div>
    {% endif %}

    <!-- Quick Stats -->
    <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 32px;">
        <div class="card text-center" style="padding: 24px;">
            <p style="font-size: 36px; font-weight: 700; color: var(--primary-maroon);">{{ followup_count|default(0)
                }}/5</p>
            <p style="color: var(--text-secondary); margin-top: 4px;">Follow-up questions used</p>
        </div>
        <div class="card text-center" style="padding: 24px;">
            <p style="font-size: 36px; font-weight: 700; color: var(--green-accent);">{{ groups_joined|default(0) }}</p>
            <p style="color: var(--text-secondary); margin-top: 4px;">Groups joined</p>
        </div>
        <div class="card text-center" style="padding: 24px;">
            <p style="font-size: 36px; font-weight: 700; color: var(--primary-gold);">{{ messages_sent|default(0) }}</p>
            <p style="color: var(--text-secondary); margin-top: 4px;">Messages sent</p>
        </div>
    </div>

    <!-- Update Profile Link -->
    <div style="margin-top: 32px; text-align: center;">
        <a href="{{ url_for('profile') }}" style="color: var(--primary-maroon); font-weight: 500;">
            âš™ï¸ Update your profile
        </a>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Sticky note functionality
    const TIP_DISMISSED_KEY = 'dashboard_tip_dismissed';

    document.addEventListener('DOMContentLoaded', function () {
        // Show tip if not dismissed before
        if (!localStorage.getItem(TIP_DISMISSED_KEY)) {
            document.getElementById('dashboardTip').style.display = 'flex';
        }
    });

    function dismissTip() {
        document.getElementById('dashboardTip').style.display = 'none';
        localStorage.setItem(TIP_DISMISSED_KEY, 'true');
    }
</script>
{% endblock %}